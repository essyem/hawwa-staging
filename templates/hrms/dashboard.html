{% extends 'hrms/base.html' %}{% extends 'hrms/base.html' %}

{% load static %}{% load static %}

{% load i18n %}{% load i18n %}



{% block hrms_title %}{% trans "Dashboard" %}{% endblock %}{% block hrms_title %}{% trans "Dashboard" %}{% endblock %}

{% block page_title %}{% trans "HRMS Dashboard" %}{% endblock %}{% block page_title %}{% trans "HRMS Dashboard" %}{% endblock %}

{% block page_subtitle %}{% block page_subtitle %}

<p class="text-muted mb-0">{% trans "Overview of human resources and organizational metrics" %}</p><p class="text-muted mb-0">{% trans "Overview of human resources and organizational metrics" %}</p>

{% endblock %}{% endblock %}



{% block breadcrumb_items %}{% block breadcrumb_items %}

<li class="breadcrumb-item active">{% trans "Dashboard" %}</li><li class="breadcrumb-item active">{% trans "Dashboard" %}</li>

{% endblock %}{% endblock %}



{% block page_actions %}{% block page_actions %}

<div class="d-flex gap-2"><div class="d-flex gap-2">

    <button class="btn btn-outline-primary" onclick="window.print()">    <button class="btn btn-outline-primary" onclick="window.print()">

        <i class="fas fa-print me-1"></i>{% trans "Print Report" %}        <i class="fas fa-print me-1"></i>{% trans "Print Report" %}

    </button>    </button>

    <a href="{% url 'hrms:employee_add' %}" class="btn btn-primary">    <a href="{% url 'hrms:employee_add' %}" class="btn btn-primary">

        <i class="fas fa-user-plus me-1"></i>{% trans "Add Employee" %}        <i class="fas fa-user-plus me-1"></i>{% trans "Add Employee" %}

    </a>    </a>

</div></div>

{% endblock %}{% endblock %}



{% block main_content %}{% block main_content %}

<!-- Statistics Cards -->

<div class="row mb-4"><!-- Statistics Cards -->

    <div class="col-xl-3 col-md-6 mb-4"><div class="row mb-4">

        <div class="hrms-stat-card">    <div class="col-xl-3 col-md-6 mb-4">

            <div class="hrms-stat-value">{{ total_employees|default:"0" }}</div>        <div class="hrms-stat-card">

            <div class="hrms-stat-label">            <div class="hrms-stat-value">{{ total_employees|default:"0" }}</div>

                <i class="fas fa-users me-1"></i>{% trans "Total Employees" %}            <div class="hrms-stat-label">

            </div>                <i class="fas fa-users me-1"></i>{% trans "Total Employees" %}

        </div>            </div>

    </div>        </div>

    <div class="col-xl-3 col-md-6 mb-4">    </div>

        <div class="hrms-stat-card" style="background: linear-gradient(135deg, var(--success) 0%, #2d5016 100%);">    <div class="col-xl-3 col-md-6 mb-4">

            <div class="hrms-stat-value">{{ active_employees|default:"0" }}</div>        <div class="hrms-stat-card" style="background: linear-gradient(135deg, var(--success) 0%, #2d5016 100%);">

            <div class="hrms-stat-label">            <div class="hrms-stat-value">{{ active_employees|default:"0" }}</div>

                <i class="fas fa-user-check me-1"></i>{% trans "Active Employees" %}            <div class="hrms-stat-label">

            </div>                <i class="fas fa-user-check me-1"></i>{% trans "Active Employees" %}

        </div>            </div>

    </div>        </div>

    <div class="col-xl-3 col-md-6 mb-4">    </div>

        <div class="hrms-stat-card" style="background: linear-gradient(135deg, var(--warning) 0%, #8b4513 100%);">    <div class="col-xl-3 col-md-6 mb-4">

            <div class="hrms-stat-value">{{ departments_count|default:"0" }}</div>        <div class="hrms-stat-card" style="background: linear-gradient(135deg, var(--warning) 0%, #8b4513 100%);">

            <div class="hrms-stat-label">            <div class="hrms-stat-value">{{ departments_count|default:"0" }}</div>

                <i class="fas fa-building me-1"></i>{% trans "Departments" %}            <div class="hrms-stat-label">

            </div>                <i class="fas fa-building me-1"></i>{% trans "Departments" %}

        </div>            </div>

    </div>        </div>

    <div class="col-xl-3 col-md-6 mb-4">    </div>

        <div class="hrms-stat-card" style="background: linear-gradient(135deg, var(--info) 0%, #1e3a8a 100%);">    <div class="col-xl-3 col-md-6 mb-4">

            <div class="hrms-stat-value">{{ pending_leaves|default:"0" }}</div>        <div class="hrms-stat-card" style="background: linear-gradient(135deg, var(--info) 0%, #1e3a8a 100%);">

            <div class="hrms-stat-label">            <div class="hrms-stat-value">{{ pending_leaves|default:"0" }}</div>

                <i class="fas fa-calendar-times me-1"></i>{% trans "Pending Leaves" %}            <div class="hrms-stat-label">

            </div>                <i class="fas fa-calendar-times me-1"></i>{% trans "Pending Leaves" %}

        </div>            </div>

    </div>        </div>

</div>    </div>

</div>

<!-- Quick Actions -->                        <div class="h5 mb-0 font-weight-bold text-gray-800">

<div class="row mb-4">                            {{ total_employees }}

    <div class="col-12">                        </div>

        <div class="hrms-card p-4">                    </div>

            <h5 class="mb-3">                    <div class="col-auto">

                <i class="fas fa-bolt me-2 text-warning"></i>{% trans "Quick Actions" %}                        <i class="fas fa-users fa-2x text-gray-300"></i>

            </h5>                    </div>

            <div class="row">                </div>

                <div class="col-md-3 mb-2">            </div>

                    <a href="{% url 'hrms:employee_add' %}" class="btn btn-outline-primary w-100 hrms-action-btn">        </div>

                        <i class="fas fa-user-plus me-2"></i>{% trans "Add Employee" %}    </div>

                    </a>    

                </div>    <div class="col-xl-3 col-md-6 mb-4">

                <div class="col-md-3 mb-2">        <div class="card border-start border-success border-4 h-100">

                    <a href="{% url 'hrms:department_add' %}" class="btn btn-outline-success w-100 hrms-action-btn">            <div class="card-body">

                        <i class="fas fa-building me-2"></i>{% trans "Add Department" %}                <div class="row no-gutters align-items-center">

                    </a>                    <div class="col mr-2">

                </div>                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">

                <div class="col-md-3 mb-2">                            Departments

                    <a href="{% url 'hrms:leave_list' %}" class="btn btn-outline-warning w-100 hrms-action-btn">                        </div>

                        <i class="fas fa-calendar-check me-2"></i>{% trans "Review Leaves" %}                        <div class="h5 mb-0 font-weight-bold text-gray-800">

                    </a>                            {{ total_departments }}

                </div>                        </div>

                <div class="col-md-3 mb-2">                    </div>

                    <a href="{% url 'hrms:payroll_list' %}" class="btn btn-outline-info w-100 hrms-action-btn">                    <div class="col-auto">

                        <i class="fas fa-money-bill-wave me-2"></i>{% trans "Payroll" %}                        <i class="fas fa-building fa-2x text-gray-300"></i>

                    </a>                    </div>

                </div>                </div>

            </div>            </div>

        </div>        </div>

    </div>    </div>

</div>    

    <div class="col-xl-3 col-md-6 mb-4">

<!-- Content Row -->        <div class="card border-start border-warning border-4 h-100">

<div class="row">            <div class="card-body">

    <!-- Recent Employees -->                <div class="row no-gutters align-items-center">

    <div class="col-xl-6 col-lg-6 mb-4">                    <div class="col mr-2">

        <div class="hrms-card">                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">

            <div class="card-header bg-transparent border-0 d-flex justify-content-between align-items-center">                            Pending Leaves

                <h6 class="mb-0">                        </div>

                    <i class="fas fa-user-plus me-2 text-primary"></i>{% trans "Recent Employees" %}                        <div class="h5 mb-0 font-weight-bold text-gray-800">

                </h6>                            {{ pending_leaves }}

                <a href="{% url 'hrms:employee_list' %}" class="btn btn-sm btn-outline-primary">                        </div>

                    <i class="fas fa-eye me-1"></i>{% trans "View All" %}                    </div>

                </a>                    <div class="col-auto">

            </div>                        <i class="fas fa-calendar-times fa-2x text-gray-300"></i>

            <div class="card-body">                    </div>

                {% if recent_employees %}                </div>

                    <div class="table-responsive">            </div>

                        <table class="table table-sm hrms-table">        </div>

                            <thead>    </div>

                                <tr>    

                                    <th>{% trans "Employee" %}</th>    <div class="col-xl-3 col-md-6 mb-4">

                                    <th>{% trans "Department" %}</th>        <div class="card border-start border-info border-4 h-100">

                                    <th>{% trans "Position" %}</th>            <div class="card-body">

                                    <th>{% trans "Joined" %}</th>                <div class="row no-gutters align-items-center">

                                </tr>                    <div class="col mr-2">

                            </thead>                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">

                            <tbody>                            Training Programs

                                {% for employee in recent_employees %}                        </div>

                                <tr>                        <div class="h5 mb-0 font-weight-bold text-gray-800">

                                    <td>                            {{ active_training_programs }}

                                        <div class="d-flex align-items-center">                        </div>

                                            <div class="employee-avatar me-2">                    </div>

                                                {{ employee.user.first_name|first|default:employee.user.email|first|upper }}                    <div class="col-auto">

                                            </div>                        <i class="fas fa-graduation-cap fa-2x text-gray-300"></i>

                                            <a href="{% url 'hrms:employee_detail' employee.pk %}" class="text-decoration-none">                    </div>

                                                {{ employee.user.get_full_name|default:employee.user.email }}                </div>

                                            </a>            </div>

                                        </div>        </div>

                                    </td>    </div>

                                    <td><span class="department-badge">{{ employee.department.name }}</span></td></div>

                                    <td>{{ employee.position.title }}</td>

                                    <td>{{ employee.hire_date|date:"M d, Y" }}</td><!-- Content Row -->

                                </tr><div class="row">

                                {% endfor %}    <!-- Recent Employees -->

                            </tbody>    <div class="col-xl-6 col-lg-6">

                        </table>        <div class="card shadow mb-4">

                    </div>            <div class="card-header py-3 d-flex justify-content-between align-items-center">

                {% else %}                <h6 class="m-0 font-weight-bold text-primary">

                    <div class="text-center py-4">                    <i class="fas fa-user-plus"></i> Recent Employees

                        <i class="fas fa-users fa-3x text-muted mb-3"></i>                </h6>

                        <p class="text-muted">{% trans "No recent employees" %}</p>                <a href="{% url 'hrms:employee_list' %}" class="btn btn-sm btn-outline-primary">

                        <a href="{% url 'hrms:employee_add' %}" class="btn btn-primary">                    <i class="fas fa-eye"></i> View All

                            <i class="fas fa-plus me-1"></i>{% trans "Add First Employee" %}                </a>

                        </a>            </div>

                    </div>            <div class="card-body">

                {% endif %}                {% if recent_employees %}

            </div>                    <div class="table-responsive">

        </div>                        <table class="table table-sm">

    </div>                            <thead>

                                <tr>

    <!-- Pending Leave Applications -->                                    <th>Name</th>

    <div class="col-xl-6 col-lg-6 mb-4">                                    <th>Department</th>

        <div class="hrms-card">                                    <th>Position</th>

            <div class="card-header bg-transparent border-0 d-flex justify-content-between align-items-center">                                    <th>Joined</th>

                <h6 class="mb-0">                                </tr>

                    <i class="fas fa-calendar-check me-2 text-warning"></i>{% trans "Pending Leave Applications" %}                            </thead>

                </h6>                            <tbody>

                <a href="{% url 'hrms:leave_list' %}" class="btn btn-sm btn-outline-warning">                                {% for employee in recent_employees %}

                    <i class="fas fa-eye me-1"></i>{% trans "View All" %}                                <tr>

                </a>                                    <td>

            </div>                                        <a href="{% url 'hrms:employee_detail' employee.pk %}" class="text-decoration-none">

            <div class="card-body">                                            {{ employee.user.get_full_name }}

                {% if pending_leave_applications %}                                        </a>

                    <div class="table-responsive">                                    </td>

                        <table class="table table-sm hrms-table">                                    <td>{{ employee.department.name }}</td>

                            <thead>                                    <td>{{ employee.position.title }}</td>

                                <tr>                                    <td>{{ employee.hire_date|date:"M d" }}</td>

                                    <th>{% trans "Employee" %}</th>                                </tr>

                                    <th>{% trans "Type" %}</th>                                {% endfor %}

                                    <th>{% trans "Duration" %}</th>                            </tbody>

                                    <th>{% trans "Action" %}</th>                        </table>

                                </tr>                    </div>

                            </thead>                {% else %}

                            <tbody>                    <p class="text-muted text-center py-3">No recent employees</p>

                                {% for leave in pending_leave_applications %}                {% endif %}

                                <tr>            </div>

                                    <td>        </div>

                                        <div class="d-flex align-items-center">    </div>

                                            <div class="employee-avatar me-2">

                                                {{ leave.employee.user.first_name|first|default:leave.employee.user.email|first|upper }}    <!-- Pending Leave Applications -->

                                            </div>    <div class="col-xl-6 col-lg-6">

                                            {{ leave.employee.user.get_full_name|default:leave.employee.user.email }}        <div class="card shadow mb-4">

                                        </div>            <div class="card-header py-3 d-flex justify-content-between align-items-center">

                                    </td>                <h6 class="m-0 font-weight-bold text-primary">

                                    <td>{{ leave.leave_type.name }}</td>                    <i class="fas fa-calendar-check"></i> Pending Leave Applications

                                    <td>                </h6>

                                        <small>{{ leave.start_date|date:"M d" }} - {{ leave.end_date|date:"M d" }}</small><br>                <a href="{% url 'hrms:leave_list' %}" class="btn btn-sm btn-outline-primary">

                                        <span class="text-muted">({{ leave.days_requested }} {% trans "days" %})</span>                    <i class="fas fa-eye"></i> View All

                                    </td>                </a>

                                    <td>            </div>

                                        <div class="btn-group btn-group-sm">            <div class="card-body">

                                            <button class="btn btn-outline-success btn-sm" onclick="approveLeave({{ leave.id }})">                {% if pending_leave_applications %}

                                                <i class="fas fa-check"></i>                    <div class="table-responsive">

                                            </button>                        <table class="table table-sm">

                                            <button class="btn btn-outline-danger btn-sm" onclick="rejectLeave({{ leave.id }})">                            <thead>

                                                <i class="fas fa-times"></i>                                <tr>

                                            </button>                                    <th>Employee</th>

                                        </div>                                    <th>Leave Type</th>

                                    </td>                                    <th>Days</th>

                                </tr>                                    <th>Applied</th>

                                {% endfor %}                                </tr>

                            </tbody>                            </thead>

                        </table>                            <tbody>

                    </div>                                {% for leave in pending_leave_applications %}

                {% else %}                                <tr>

                    <div class="text-center py-4">                                    <td>

                        <i class="fas fa-calendar-check fa-3x text-muted mb-3"></i>                                        <a href="{% url 'hrms:leave_detail' leave.pk %}" class="text-decoration-none">

                        <p class="text-muted">{% trans "No pending leave applications" %}</p>                                            {{ leave.employee.user.get_full_name }}

                    </div>                                        </a>

                {% endif %}                                    </td>

            </div>                                    <td>{{ leave.leave_type.name }}</td>

        </div>                                    <td>{{ leave.total_days }}</td>

    </div>                                    <td>{{ leave.applied_on|date:"M d" }}</td>

</div>                                </tr>

                                {% endfor %}

<!-- Department Overview -->                            </tbody>

<div class="row">                        </table>

    <div class="col-12">                    </div>

        <div class="hrms-card">                {% else %}

            <div class="card-header bg-transparent border-0">                    <p class="text-muted text-center py-3">No pending leave applications</p>

                <h6 class="mb-0">                {% endif %}

                    <i class="fas fa-building me-2 text-info"></i>{% trans "Department Overview" %}            </div>

                </h6>        </div>

            </div>    </div>

            <div class="card-body"></div>

                {% if departments %}

                    <div class="row"><!-- Quick Actions -->

                        {% for dept in departments %}<div class="row">

                        <div class="col-md-4 mb-3">    <div class="col-12">

                            <div class="p-3 border rounded">        <div class="card shadow mb-4">

                                <div class="d-flex justify-content-between align-items-center mb-2">            <div class="card-header py-3">

                                    <h6 class="mb-0">{{ dept.name }}</h6>                <h6 class="m-0 font-weight-bold text-primary">

                                    <span class="badge bg-primary">{{ dept.employee_count }} {% trans "employees" %}</span>                    <i class="fas fa-bolt"></i> Quick Actions

                                </div>                </h6>

                                <p class="text-muted small mb-0">{{ dept.description|truncatewords:10 }}</p>            </div>

                                <div class="mt-2">            <div class="card-body">

                                    <a href="{% url 'hrms:department_detail' dept.pk %}" class="btn btn-sm btn-outline-primary">                <div class="row">

                                        {% trans "View Details" %}                    {% if user.is_staff %}

                                    </a>                    <div class="col-md-3 mb-3">

                                </div>                        <a href="{% url 'hrms:employee_add' %}" class="btn btn-outline-primary btn-lg w-100 h-100 d-flex flex-column justify-content-center">

                            </div>                            <i class="fas fa-user-plus fa-2x mb-2"></i>

                        </div>                            <span>Add Employee</span>

                        {% endfor %}                        </a>

                    </div>                    </div>

                {% else %}                    <div class="col-md-3 mb-3">

                    <div class="text-center py-4">                        <a href="{% url 'hrms:department_add' %}" class="btn btn-outline-success btn-lg w-100 h-100 d-flex flex-column justify-content-center">

                        <i class="fas fa-building fa-3x text-muted mb-3"></i>                            <i class="fas fa-building fa-2x mb-2"></i>

                        <p class="text-muted">{% trans "No departments found" %}</p>                            <span>Add Department</span>

                        <a href="{% url 'hrms:department_add' %}" class="btn btn-primary">                        </a>

                            <i class="fas fa-plus me-1"></i>{% trans "Create Department" %}                    </div>

                        </a>                    {% endif %}

                    </div>                    <div class="col-md-3 mb-3">

                {% endif %}                        <a href="{% url 'hrms:leave_apply' %}" class="btn btn-outline-warning btn-lg w-100 h-100 d-flex flex-column justify-content-center">

            </div>                            <i class="fas fa-calendar-plus fa-2x mb-2"></i>

        </div>                            <span>Apply Leave</span>

    </div>                        </a>

</div>                    </div>

                    <div class="col-md-3 mb-3">

<script>                        <a href="{% url 'hrms:training_programs' %}" class="btn btn-outline-info btn-lg w-100 h-100 d-flex flex-column justify-content-center">

function approveLeave(leaveId) {                            <i class="fas fa-graduation-cap fa-2x mb-2"></i>

    if (confirm('{% trans "Are you sure you want to approve this leave request?" %}')) {                            <span>Browse Training</span>

        // Implementation for leave approval                        </a>

        showHRMSToast('{% trans "Leave request approved successfully" %}', 'success');                    </div>

    }                </div>

}            </div>

        </div>

function rejectLeave(leaveId) {    </div>

    if (confirm('{% trans "Are you sure you want to reject this leave request?" %}')) {</div>

        // Implementation for leave rejection

        showHRMSToast('{% trans "Leave request rejected" %}', 'info');<!-- Upcoming Training Sessions -->

    }{% if upcoming_training %}

}<div class="row">

</script>    <div class="col-12">

{% endblock %}        <div class="card shadow mb-4">
            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                <h6 class="m-0 font-weight-bold text-primary">
                    <i class="fas fa-calendar-alt"></i> Upcoming Training Sessions
                </h6>
                <a href="{% url 'hrms:training_dashboard' %}" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-eye"></i> View All
                </a>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Program</th>
                                <th>Start Date</th>
                                <th>Duration</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for session in upcoming_training %}
                            <tr>
                                <td>
                                    <a href="{% url 'hrms:training_program_detail' session.program.pk %}" class="text-decoration-none">
                                        {{ session.program.title }}
                                    </a>
                                </td>
                                <td>{{ session.start_date|date:"M d, Y" }}</td>
                                <td>{{ session.program.duration_hours }} hours</td>
                                <td>
                                    <span class="badge bg-success">{{ session.status|title }}</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_css %}
<style>
    .card {
        box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
        border: 1px solid rgba(58, 59, 69, 0.15);
    }
    
    .text-xs {
        font-size: 0.7rem;
    }
    
    .border-start {
        border-left: 0.25rem solid!important;
    }
    
    .quick-action-btn {
        transition: all 0.3s ease;
    }
    
    .quick-action-btn:hover {
        transform: translateY(-5px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }
</style>
{% endblock %}
