{% extends "base/base.html" %}
{% load i18n crispy_forms_tags %}

{# This is the public base template for non-admin pages #}
{# It includes the normal header/navbar for public users #}

{% block header %}
    {% include 'includes/header.html' %}
{% endblock %}

{% block extra_js %}
{{ block.super }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            const html = document.documentElement;
            const savedTheme = localStorage.getItem('theme') || 'light';
            html.setAttribute('data-theme', savedTheme);
            function updateIcon(theme) {
                if (theme === 'dark') {
                    themeIcon.className = 'fas fa-sun';
                    themeToggle.setAttribute('aria-pressed', 'true');
                } else {
                    themeIcon.className = 'fas fa-moon';
                    themeToggle.setAttribute('aria-pressed', 'false');
                }
            }
            updateIcon(savedTheme);
            if (themeToggle) {
                themeToggle.addEventListener('click', function() {
                    const currentTheme = html.getAttribute('data-theme');
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                    html.setAttribute('data-theme', newTheme);
                    localStorage.setItem('theme', newTheme);
                    updateIcon(newTheme);
                });
            }
        });
    </script>
{% endblock %}